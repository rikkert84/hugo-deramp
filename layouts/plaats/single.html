{{ define "main" }}
<div class="plaats-detail">
  <!-- Header met kaart -->
  <header style="margin-bottom: 2rem;">
    <h1>{{ .Title }}</h1>
    {{ if .Params.aantal_slachtoffers }}
      <div style="background: #e74c3c; color: white; display: inline-block; padding: 0.5rem 1rem; border-radius: 999px; font-weight: bold;">
        {{ .Params.aantal_slachtoffers }} slachtoffers
      </div>
    {{ end }}
    
    <!-- Mini-kaart van deze plaats -->
    <div id="plaats-map" style="height: 300px; margin: 1rem 0; border-radius: 8px;"></div>
  </header>

  <!-- Namenlijst -->
  <section class="slachtoffers">
    <h2>Slachtoffers uit {{ .Title }}</h2>
    
    <!-- Filter -->
    <div style="margin: 1.5rem 0;">
      <input type="text" id="plaats-search" placeholder="üîç Zoek in namen..." 
             style="padding: 0.75rem; border: 1px solid #ddd; border-radius: 4px; width: 300px;">
    </div>

    <div class="namen-grid">
      {{ $namen := where .Site.Pages "Params.overlijdensplaats" .Title }}
      {{ range $namen.ByParam "sorteren" }}
        <div class="naam-card" 
             data-naam="{{ .Title | lower }}"
             style="padding: 1rem; border: 1px solid #eee; border-radius: 8px; margin-bottom: 1rem;">
          <h4 style="margin: 0 0 0.25rem 0; color: #2c3e50;">{{ .Title }}</h4>
          
          {{ if .Params.geboortedatum }}
            <div style="font-size: 0.9rem; color: #7f8c8d;">
              <strong>Geb.</strong> {{ .Params.geboortedatum | time.AsTime | time.Format "2 Jan 1950" }}
              {{ if .Params.geboorteplaats }} ‚Ä¢ {{ .Params.geboorteplaats }}{{ end }}
            </div>
          {{ end }}
          
          {{ if .Params.leeftijd }}
            <div style="font-size: 0.9rem; color: #e74c3c; font-weight: 500;">
              Leeftijd: {{ .Params.leeftijd }}
            </div>
          {{ end }}
          
          <a href="{{ .Permalink }}" style="display: inline-block; margin-top: 0.5rem; color: #3498db;">Volledige details ‚Üí</a>
        </div>
      {{ end }}
    </div>

    <!-- Counter -->
    <p id="namen-count" style="text-align: center; color: #7f8c8d; margin-top: 1rem;">
      <em>{{ len $namen }} namen gevonden</em>
    </p>
  </section>
</div>

<!-- Leaflet voor mini-kaart -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
const map = L.map('plaats-map').setView([{{ .Params.co√∂rdinaten }}], 14);
L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png').addTo(map);

// Marker voor deze plaats
L.marker([{{ .Params.co√∂rdinaten }}]).bindPopup('<b>{{ .Title }}</b>').addTo(map);

// Filter functionaliteit
const searchInput = document.getElementById('plaats-search');
const items = document.querySelectorAll('.naam-card');
let totalNamen = {{ len $namen }};

searchInput.addEventListener('input', function() {
  const q = this.value.toLowerCase().trim();
  let visible = 0;
  
  items.forEach(item => {
    const naam = item.dataset.naam || '';
    if (q && !naam.includes(q)) {
      item.style.display = 'none';
    } else {
      item.style.display = '';
      visible++;
    }
  });
  
  document.getElementById('namen-count').textContent = 
    `Gevonden: ${visible} van ${totalNamen} namen`;
});
</script>

<style>
.plaats-detail {
  max-width: 1200px;
  margin: 0 auto;
  padding: 2rem;
}
.namen-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
  gap: 1.5rem;
}
.naam-card:hover {
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  transform: translateY(-1px);
  transition: all 0.2s;
}
@media (max-width: 768px) {
  .namen-grid {
    grid-template-columns: 1fr;
  }
}
</style>

{{ end }}
